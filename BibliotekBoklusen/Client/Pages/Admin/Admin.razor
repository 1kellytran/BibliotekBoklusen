@page "/admin"
@attribute [Authorize(Roles = "Librarian, Admin")]
@inject ISearchManager SearchManager
@inject IUserManager UserManager
@inject ILoanManager LoanManager

<MudPaper Width="250px" Class="d-inline-flex py-3" Elevation="0">
    <MudNavMenu Class="mud-width-full">
        <MudText Typo="Typo.h6" Class="px-4">Admin</MudText>
        <MudText Typo="Typo.body2" Class="px-4 mud-text-secondary">Meny</MudText>
        <MudDivider Class="my-2" />
        <MudNavLink Icon="fas fa-chart-line">Rapporter</MudNavLink>
        <MudNavGroup Title="Produkter" Icon="fas fa-cogs" Expanded="false">
            <MudNavLink Href="/allproducts" Icon="fas fa-server">Alla produkter</MudNavLink>
            <MudNavLink Href="/createproduct" Icon="fas fa-server">Lägg till produkter</MudNavLink>
            <MudNavLink Href="/returnproducts" Icon="fas fa-server">Returnera</MudNavLink>
             <MudNavGroup Title="Kategorier" Icon="fas fa-cogs" Expanded="false">
                   <MudNavLink Href="/categories" Icon="fas fa-server">Kategorier</MudNavLink>
                   </MudNavGroup>
        </MudNavGroup>
        <MudNavGroup Title="Seminarium" Icon="fas fa-cogs" Expanded="false">
            <MudNavLink Href="/seminar" Icon="fas fa-receipt">Kommande seminarium</MudNavLink>
            <MudNavLink Href="/seminar" Icon="fas fa-receipt">Lägg till seminarium</MudNavLink>
        </MudNavGroup>
        <MudNavGroup Title="Personal" Icon="fas fa-users" Expanded="false">
            <MudNavLink Href="/register" Icon="fas fa-users" IconColor="Color.Success">Administrera personal</MudNavLink>
        </MudNavGroup>
                <MudNavGroup Title="Medlemmar" Icon="fas fa-users" Expanded="false">
            <MudNavLink Href="/members" Icon="fas fa-users" IconColor="Color.Success">Alla medlemmar</MudNavLink>
        </MudNavGroup>
    </MudNavMenu>
</MudPaper>


@code {

    private string searchWord = "";
    public List<User> Users { get; set; } = new();
    UpdatedUserDto User = new();
    private int copyToReturn;

    async Task ReturnLoan()
    {
        await LoanManager.ReturnLoanAsync(copyToReturn);
    }
    async Task EditUser(int userId, User user)
    {
        User.FirstName = user.FirstName;
        User.LastName = user.LastName;

        await UserManager.UpdateUserinformation(User, userId);
    }
    async Task DeleteUser(int userId)
    {
        await UserManager.DeleteUser(userId);
        Users = await SearchManager.SearchMember(searchWord);
    }

}
